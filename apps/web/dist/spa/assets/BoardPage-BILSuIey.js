import{g as se,r as lt,x as Mn,u as qn,e as Sn,a0 as fr,w as Ot,o as Cn,d as Pe,q as pr,l as cn,s as mr,c as gr,a as mt,v as vr,a1 as yr,h as un,b as br,a2 as _r,A as wr,I as Si,a3 as Er,X as N,F as Ci,G as Sr,a4 as Ue,S as Tn,a5 as He,J as Tt,K as R,a6 as Cr,R as tt,U,V as jt,W as Rt,L as x,Y as wt,Q as ut,N as ce,Z as Tr,_ as $e,$ as We,B as Ye,O as Vn}from"./index-Bve56w8L.js";import{p as Fn,i as xr,j as kr,k as Ar,l as Or,m as Dr,r as Un,n as Rr,o as Br,q as Nr,a as nt,e as oe,Q as Ir,u as Pr,c as Hn,d as zt,f as Lt,C as Xe,b as $n,g as Wn,h as Lr}from"./errors-g7rgJ-Bd.js";import{c as Mr,Q as Yn,b as Xn,d as je,a as jn}from"./selection-DD4qxAqs.js";import{k as qr,u as Vr,s as Fr,a as Ur,b as Hr,c as $r,d as Wr,e as Yr,h as Xr,n as jr,l as zr,Q as ue}from"./user-o0XP6R18.js";const Qr={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},Kr={...Qr,contextMenu:Boolean};function Jr({showing:t,avoidEmit:e,configureAnchorEl:n}){const{props:i,proxy:r,emit:o}=se(),s=lt(null);let l=null;function a(d){return s.value===null?!1:d===void 0||d.touches===void 0||d.touches.length<=1}const c={};n===void 0&&(Object.assign(c,{hide(d){r.hide(d)},toggle(d){r.toggle(d),d.qAnchorHandled=!0},toggleKey(d){fr(d,13)===!0&&c.toggle(d)},contextClick(d){r.hide(d),Mn(d),Sn(()=>{r.show(d),d.qAnchorHandled=!0})},prevent:Mn,mobileTouch(d){if(c.mobileCleanup(d),a(d)!==!0)return;r.hide(d),s.value.classList.add("non-selectable");const g=d.target;qn(c,"anchor",[[g,"touchmove","mobileCleanup","passive"],[g,"touchend","mobileCleanup","passive"],[g,"touchcancel","mobileCleanup","passive"],[s.value,"contextmenu","prevent","notPassive"]]),l=setTimeout(()=>{l=null,r.show(d),d.qAnchorHandled=!0},300)},mobileCleanup(d){s.value.classList.remove("non-selectable"),l!==null&&(clearTimeout(l),l=null),t.value===!0&&d!==void 0&&Mr()}}),n=function(d=i.contextMenu){if(i.noParentEvent===!0||s.value===null)return;let g;d===!0?r.$q.platform.is.mobile===!0?g=[[s.value,"touchstart","mobileTouch","passive"]]:g=[[s.value,"mousedown","hide","passive"],[s.value,"contextmenu","contextClick","notPassive"]]:g=[[s.value,"click","toggle","passive"],[s.value,"keyup","toggleKey","passive"]],qn(c,"anchor",g)});function u(){pr(c,"anchor")}function f(d){for(s.value=d;s.value.classList.contains("q-anchor--skip");)s.value=s.value.parentNode;n()}function y(){if(i.target===!1||i.target===""||r.$el.parentNode===null)s.value=null;else if(i.target===!0)f(r.$el.parentNode);else{let d=i.target;if(typeof i.target=="string")try{d=document.querySelector(i.target)}catch{d=void 0}d!=null?(s.value=d.$el||d,n()):(s.value=null,console.error(`Anchor: target "${i.target}" not found`))}}return Ot(()=>i.contextMenu,d=>{s.value!==null&&(u(),n(d))}),Ot(()=>i.target,()=>{s.value!==null&&u(),y()}),Ot(()=>i.noParentEvent,d=>{s.value!==null&&(d===!0?u():n())}),Cn(()=>{y(),e!==!0&&i.modelValue===!0&&s.value===null&&o("update:modelValue",!1)}),Pe(()=>{l!==null&&clearTimeout(l),u()}),{anchorEl:s,canShow:a,anchorEvents:c}}function Gr(t,e){const n=lt(null);let i;function r(l,a){const c=`${a!==void 0?"add":"remove"}EventListener`,u=a!==void 0?a:i;l!==window&&l[c]("scroll",u,cn.passive),window[c]("scroll",u,cn.passive),i=a}function o(){n.value!==null&&(r(n.value),n.value=null)}const s=Ot(()=>t.noParentEvent,()=>{n.value!==null&&(o(),e())});return Pe(s),{localScrollTarget:n,unconfigureScrollTarget:o,changeScrollEvent:r}}const{notPassiveCapture:xe}=cn,Pt=[];function ke(t){const e=t.target;if(e===void 0||e.nodeType===8||e.classList.contains("no-pointer-events")===!0)return;let n=Fn.length-1;for(;n>=0;){const i=Fn[n].$;if(i.type.name==="QTooltip"){n--;continue}if(i.type.name!=="QDialog")break;if(i.props.seamless!==!0)return;n--}for(let i=Pt.length-1;i>=0;i--){const r=Pt[i];if((r.anchorEl.value===null||r.anchorEl.value.contains(e)===!1)&&(e===document.body||r.innerRef.value!==null&&r.innerRef.value.contains(e)===!1))t.qClickOutside=!0,r.onClickOutside(t);else return}}function Zr(t){Pt.push(t),Pt.length===1&&(document.addEventListener("mousedown",ke,xe),document.addEventListener("touchstart",ke,xe))}function zn(t){const e=Pt.findIndex(n=>n===t);e!==-1&&(Pt.splice(e,1),Pt.length===0&&(document.removeEventListener("mousedown",ke,xe),document.removeEventListener("touchstart",ke,xe)))}let Qn,Kn;function Jn(t){const e=t.split(" ");return e.length!==2?!1:["top","center","bottom"].includes(e[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(e[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function to(t){return t?!(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number"):!0}const dn={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(t=>{dn[`${t}#ltr`]=t,dn[`${t}#rtl`]=t});function Gn(t,e){const n=t.split(" ");return{vertical:n[0],horizontal:dn[`${n[1]}#${e===!0?"rtl":"ltr"}`]}}function eo(t,e){let{top:n,left:i,right:r,bottom:o,width:s,height:l}=t.getBoundingClientRect();return e!==void 0&&(n-=e[1],i-=e[0],o+=e[1],r+=e[0],s+=e[0],l+=e[1]),{top:n,bottom:o,height:l,left:i,right:r,width:s,middle:i+(r-i)/2,center:n+(o-n)/2}}function no(t,e,n){let{top:i,left:r}=t.getBoundingClientRect();return i+=e.top,r+=e.left,n!==void 0&&(i+=n[1],r+=n[0]),{top:i,bottom:i+1,height:1,left:r,right:r+1,width:1,middle:r,center:i}}function io(t,e){return{top:0,center:e/2,bottom:e,left:0,middle:t/2,right:t}}function Zn(t,e,n,i){return{top:t[n.vertical]-e[i.vertical],left:t[n.horizontal]-e[i.horizontal]}}function Ti(t,e=0){if(t.targetEl===null||t.anchorEl===null||e>5)return;if(t.targetEl.offsetHeight===0||t.targetEl.offsetWidth===0){setTimeout(()=>{Ti(t,e+1)},10);return}const{targetEl:n,offset:i,anchorEl:r,anchorOrigin:o,selfOrigin:s,absoluteOffset:l,fit:a,cover:c,maxHeight:u,maxWidth:f}=t;if(mr.is.ios===!0&&window.visualViewport!==void 0){const K=document.body.style,{offsetLeft:L,offsetTop:X}=window.visualViewport;L!==Qn&&(K.setProperty("--q-pe-left",L+"px"),Qn=L),X!==Kn&&(K.setProperty("--q-pe-top",X+"px"),Kn=X)}const{scrollLeft:y,scrollTop:d}=n,g=l===void 0?eo(r,c===!0?[0,0]:i):no(r,l,i);Object.assign(n.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:f,maxHeight:u,visibility:"visible"});const{offsetWidth:C,offsetHeight:$}=n,{elWidth:P,elHeight:J}=a===!0||c===!0?{elWidth:Math.max(g.width,C),elHeight:c===!0?Math.max(g.height,$):$}:{elWidth:C,elHeight:$};let k={maxWidth:f,maxHeight:u};(a===!0||c===!0)&&(k.minWidth=g.width+"px",c===!0&&(k.minHeight=g.height+"px")),Object.assign(n.style,k);const W=io(P,J);let O=Zn(g,W,o,s);if(l===void 0||i===void 0)ze(O,g,W,o,s);else{const{top:K,left:L}=O;ze(O,g,W,o,s);let X=!1;if(O.top!==K){X=!0;const M=2*i[1];g.center=g.top-=M,g.bottom-=M+2}if(O.left!==L){X=!0;const M=2*i[0];g.middle=g.left-=M,g.right-=M+2}X===!0&&(O=Zn(g,W,o,s),ze(O,g,W,o,s))}k={top:O.top+"px",left:O.left+"px"},O.maxHeight!==void 0&&(k.maxHeight=O.maxHeight+"px",g.height>O.maxHeight&&(k.minHeight=k.maxHeight)),O.maxWidth!==void 0&&(k.maxWidth=O.maxWidth+"px",g.width>O.maxWidth&&(k.minWidth=k.maxWidth)),Object.assign(n.style,k),n.scrollTop!==d&&(n.scrollTop=d),n.scrollLeft!==y&&(n.scrollLeft=y)}function ze(t,e,n,i,r){const o=n.bottom,s=n.right,l=qr(),a=window.innerHeight-l,c=document.body.clientWidth;if(t.top<0||t.top+o>a)if(r.vertical==="center")t.top=e[i.vertical]>a/2?Math.max(0,a-o):0,t.maxHeight=Math.min(o,a);else if(e[i.vertical]>a/2){const u=Math.min(a,i.vertical==="center"?e.center:i.vertical===r.vertical?e.bottom:e.top);t.maxHeight=Math.min(o,u),t.top=Math.max(0,u-o)}else t.top=Math.max(0,i.vertical==="center"?e.center:i.vertical===r.vertical?e.top:e.bottom),t.maxHeight=Math.min(o,a-t.top);if(t.left<0||t.left+s>c)if(t.maxWidth=Math.min(s,c),r.horizontal==="middle")t.left=e[i.horizontal]>c/2?Math.max(0,c-s):0;else if(e[i.horizontal]>c/2){const u=Math.min(c,i.horizontal==="middle"?e.middle:i.horizontal===r.horizontal?e.right:e.left);t.maxWidth=Math.min(s,u),t.left=Math.max(0,u-t.maxWidth)}else t.left=Math.max(0,i.horizontal==="middle"?e.middle:i.horizontal===r.horizontal?e.left:e.right),t.maxWidth=Math.min(s,c-t.left)}const ro=gr({name:"QMenu",inheritAttrs:!1,props:{...Kr,...Hr,...Ur,...xr,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Jn},self:{type:String,validator:Jn},offset:{type:Array,validator:to},scrollTarget:Fr,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Vr,"click","escapeKey"],setup(t,{slots:e,emit:n,attrs:i}){let r=null,o,s,l;const a=se(),{proxy:c}=a,{$q:u}=c,f=lt(null),y=lt(!1),d=mt(()=>t.persistent!==!0&&t.noRouteDismiss!==!0),g=$r(t,u),{registerTick:C,removeTick:$}=kr(),{registerTimeout:P}=Wr(),{transitionProps:J,transitionStyle:k}=Ar(t),{localScrollTarget:W,changeScrollEvent:O,unconfigureScrollTarget:K}=Gr(t,Pn),{anchorEl:L,canShow:X}=Jr({showing:y}),{hide:M}=Yr({showing:y,canShow:X,handleShow:Yt,handleHide:lr,hideOnRouteChange:d,processOnMount:!0}),{showPortal:b,hidePortal:p,renderPortal:v}=Or(a,f,ur,"menu"),m={anchorEl:L,innerRef:f,onClickOutside(A){if(t.persistent!==!0&&y.value===!0)return M(A),(A.type==="touchstart"||A.target.classList.contains("q-dialog__backdrop"))&&wr(A),!0}},_=mt(()=>Gn(t.anchor||(t.cover===!0?"center middle":"bottom start"),u.lang.rtl)),I=mt(()=>t.cover===!0?_.value:Gn(t.self||"top start",u.lang.rtl)),F=mt(()=>(t.square===!0?" q-menu--square":"")+(g.value===!0?" q-menu--dark q-dark":"")),Y=mt(()=>t.autoClose===!0?{onClick:cr}:{}),_t=mt(()=>y.value===!0&&t.persistent!==!0);Ot(_t,A=>{A===!0?(Dr(Ve),Zr(m)):(Un(Ve),zn(m))});function pt(){jr(()=>{let A=f.value;A&&A.contains(document.activeElement)!==!0&&(A=A.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||A.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||A.querySelector("[autofocus], [data-autofocus]")||A,A.focus({preventScroll:!0}))})}function Yt(A){if(r=t.noRefocus===!1?document.activeElement:null,Rr(Ln),b(),Pn(),o=void 0,A!==void 0&&(t.touchPosition||t.contextMenu)){const Fe=vr(A);if(Fe.left!==void 0){const{top:dr,left:hr}=L.value.getBoundingClientRect();o={left:Fe.left-hr,top:Fe.top-dr}}}s===void 0&&(s=Ot(()=>u.screen.width+"|"+u.screen.height+"|"+t.self+"|"+t.anchor+"|"+u.lang.rtl,Xt)),t.noFocus!==!0&&document.activeElement.blur(),C(()=>{Xt(),t.noFocus!==!0&&pt()}),P(()=>{u.platform.is.ios===!0&&(l=t.autoClose,f.value.click()),Xt(),b(!0),n("show",A)},t.transitionDuration)}function lr(A){$(),p(),In(!0),r!==null&&(A===void 0||A.qClickOutside!==!0)&&(((A?.type.indexOf("key")===0?r.closest('[tabindex]:not([tabindex^="-"])'):void 0)||r).focus(),r=null),P(()=>{p(!0),n("hide",A)},t.transitionDuration)}function In(A){o=void 0,s!==void 0&&(s(),s=void 0),(A===!0||y.value===!0)&&(Br(Ln),K(),zn(m),Un(Ve)),A!==!0&&(r=null)}function Pn(){(L.value!==null||t.scrollTarget!==void 0)&&(W.value=Xr(L.value,t.scrollTarget),O(W.value,Xt))}function cr(A){l!==!0?(Nr(c,A),n("click",A)):l=!1}function Ln(A){_t.value===!0&&t.noFocus!==!0&&yr(f.value,A.target)!==!0&&pt()}function Ve(A){t.noEscDismiss!==!0&&(n("escapeKey"),M(A))}function Xt(){Ti({targetEl:f.value,offset:t.offset,anchorEl:L.value,anchorOrigin:_.value,selfOrigin:I.value,absoluteOffset:o,fit:t.fit,cover:t.cover,maxHeight:t.maxHeight,maxWidth:t.maxWidth})}function ur(){return un(_r,J.value,()=>y.value===!0?un("div",{role:"menu",...i,ref:f,tabindex:-1,class:["q-menu q-position-engine scroll"+F.value,i.class],style:[i.style,k.value],...Y.value},br(e.default)):null)}return Pe(In),Object.assign(c,{focus:pt,updatePosition:Xt}),v}});var oo=Object.defineProperty,Ae=Object.getOwnPropertySymbols,xi=Object.prototype.hasOwnProperty,ki=Object.prototype.propertyIsEnumerable,ti=(t,e,n)=>e in t?oo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ft=(t,e)=>{for(var n in e||(e={}))xi.call(e,n)&&ti(t,n,e[n]);if(Ae)for(var n of Ae(e))ki.call(e,n)&&ti(t,n,e[n]);return t},Ai=(t,e)=>{var n={};for(var i in t)xi.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&Ae)for(var i of Ae(t))e.indexOf(i)<0&&ki.call(t,i)&&(n[i]=t[i]);return n};const Oi="[vue-draggable-plus]: ";function so(t){console.warn(Oi+t)}function ao(t){console.error(Oi+t)}function ei(t,e,n){return n>=0&&n<t.length&&t.splice(n,0,t.splice(e,1)[0]),t}function lo(t){return t.replace(/-(\w)/g,(e,n)=>n?n.toUpperCase():"")}function co(t){return Object.keys(t).reduce((e,n)=>(typeof t[n]<"u"&&(e[lo(n)]=t[n]),e),{})}function ni(t,e){return Array.isArray(t)&&t.splice(e,1),t}function ii(t,e,n){return Array.isArray(t)&&t.splice(e,0,n),t}function uo(t){return typeof t>"u"}function ho(t){return typeof t=="string"}function ri(t,e,n){const i=t.children[n];t.insertBefore(e,i)}function Qe(t){t.parentNode&&t.parentNode.removeChild(t)}function fo(t,e=document){var n;let i=null;return typeof e?.querySelector=="function"?i=(n=e?.querySelector)==null?void 0:n.call(e,t):i=document.querySelector(t),i||so(`Element not found: ${t}`),i}function po(t,e,n=null){return function(...i){return t.apply(n,i),e.apply(n,i)}}function mo(t,e){const n=Ft({},t);return Object.keys(e).forEach(i=>{n[i]?n[i]=po(t[i],e[i]):n[i]=e[i]}),n}function go(t){return t instanceof HTMLElement}function oi(t,e){Object.keys(t).forEach(n=>{e(n,t[n])})}function vo(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97)}const yo=Object.assign;function si(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?si(Object(n),!0).forEach(function(i){bo(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):si(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ve(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ve=function(e){return typeof e}:ve=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(t)}function bo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function St(){return St=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},St.apply(this,arguments)}function _o(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function wo(t,e){if(t==null)return{};var n=_o(t,e),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}var Eo="1.15.2";function Et(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Ct=Et(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ae=Et(/Edge/i),ai=Et(/firefox/i),te=Et(/safari/i)&&!Et(/chrome/i)&&!Et(/android/i),Di=Et(/iP(ad|od|hone)/i),Ri=Et(/chrome/i)&&Et(/android/i),Bi={capture:!1,passive:!1};function B(t,e,n){t.addEventListener(e,n,!Ct&&Bi)}function D(t,e,n){t.removeEventListener(e,n,!Ct&&Bi)}function Oe(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function So(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ht(t,e,n,i){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&Oe(t,e):Oe(t,e))||i&&t===n)return t;if(t===n)break}while(t=So(t))}return null}var li=/\s+/g;function rt(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(li," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(li," ")}}function w(t,e,n){var i=t&&t.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=n+(typeof n=="string"?"":"px")}}function Ht(t,e){var n="";if(typeof t=="string")n=t;else do{var i=w(t,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function Ni(t,e,n){if(t){var i=t.getElementsByTagName(e),r=0,o=i.length;if(n)for(;r<o;r++)n(i[r],r);return i}return[]}function gt(){var t=document.scrollingElement;return t||document.documentElement}function z(t,e,n,i,r){if(!(!t.getBoundingClientRect&&t!==window)){var o,s,l,a,c,u,f;if(t!==window&&t.parentNode&&t!==gt()?(o=t.getBoundingClientRect(),s=o.top,l=o.left,a=o.bottom,c=o.right,u=o.height,f=o.width):(s=0,l=0,a=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||n)&&t!==window&&(r=r||t.parentNode,!Ct))do if(r&&r.getBoundingClientRect&&(w(r,"transform")!=="none"||n&&w(r,"position")!=="static")){var y=r.getBoundingClientRect();s-=y.top+parseInt(w(r,"border-top-width")),l-=y.left+parseInt(w(r,"border-left-width")),a=s+o.height,c=l+o.width;break}while(r=r.parentNode);if(i&&t!==window){var d=Ht(r||t),g=d&&d.a,C=d&&d.d;d&&(s/=C,l/=g,f/=g,u/=C,a=s+u,c=l+f)}return{top:s,left:l,bottom:a,right:c,width:f,height:u}}}function ci(t,e,n){for(var i=At(t,!0),r=z(t)[e];i;){var o=z(i)[n],s=void 0;if(s=r>=o,!s)return i;if(i===gt())break;i=At(i,!1)}return!1}function $t(t,e,n,i){for(var r=0,o=0,s=t.children;o<s.length;){if(s[o].style.display!=="none"&&s[o]!==E.ghost&&(i||s[o]!==E.dragged)&&ht(s[o],n.draggable,t,!1)){if(r===e)return s[o];r++}o++}return null}function xn(t,e){for(var n=t.lastElementChild;n&&(n===E.ghost||w(n,"display")==="none"||e&&!Oe(n,e));)n=n.previousElementSibling;return n||null}function at(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==E.clone&&(!e||Oe(t,e))&&n++;return n}function ui(t){var e=0,n=0,i=gt();if(t)do{var r=Ht(t),o=r.a,s=r.d;e+=t.scrollLeft*o,n+=t.scrollTop*s}while(t!==i&&(t=t.parentNode));return[e,n]}function Co(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n)}return-1}function At(t,e){if(!t||!t.getBoundingClientRect)return gt();var n=t,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=w(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return gt();if(i||e)return n;i=!0}}while(n=n.parentNode);return gt()}function To(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Ke(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var ee;function Ii(t,e){return function(){if(!ee){var n=arguments,i=this;n.length===1?t.call(i,n[0]):t.apply(i,n),ee=setTimeout(function(){ee=void 0},e)}}}function xo(){clearTimeout(ee),ee=void 0}function Pi(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function Li(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function Mi(t,e,n){var i={};return Array.from(t.children).forEach(function(r){var o,s,l,a;if(!(!ht(r,e.draggable,t,!1)||r.animated||r===n)){var c=z(r);i.left=Math.min((o=i.left)!==null&&o!==void 0?o:1/0,c.left),i.top=Math.min((s=i.top)!==null&&s!==void 0?s:1/0,c.top),i.right=Math.max((l=i.right)!==null&&l!==void 0?l:-1/0,c.right),i.bottom=Math.max((a=i.bottom)!==null&&a!==void 0?a:-1/0,c.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var st="Sortable"+new Date().getTime();function ko(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(i){if(!(w(i,"display")==="none"||i===E.ghost)){t.push({target:i,rect:z(i)});var r=yt({},t[t.length-1].rect);if(i.thisAnimationDuration){var o=Ht(i,!0);o&&(r.top-=o.f,r.left-=o.e)}i.fromRect=r}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(Co(t,{target:n}),1)},animateAll:function(n){var i=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var r=!1,o=0;t.forEach(function(s){var l=0,a=s.target,c=a.fromRect,u=z(a),f=a.prevFromRect,y=a.prevToRect,d=s.rect,g=Ht(a,!0);g&&(u.top-=g.f,u.left-=g.e),a.toRect=u,a.thisAnimationDuration&&Ke(f,u)&&!Ke(c,u)&&(d.top-u.top)/(d.left-u.left)===(c.top-u.top)/(c.left-u.left)&&(l=Oo(d,f,y,i.options)),Ke(u,c)||(a.prevFromRect=c,a.prevToRect=u,l||(l=i.options.animation),i.animate(a,d,u,l)),l&&(r=!0,o=Math.max(o,l),clearTimeout(a.animationResetTimer),a.animationResetTimer=setTimeout(function(){a.animationTime=0,a.prevFromRect=null,a.fromRect=null,a.prevToRect=null,a.thisAnimationDuration=null},l),a.thisAnimationDuration=l)}),clearTimeout(e),r?e=setTimeout(function(){typeof n=="function"&&n()},o):typeof n=="function"&&n(),t=[]},animate:function(n,i,r,o){if(o){w(n,"transition",""),w(n,"transform","");var s=Ht(this.el),l=s&&s.a,a=s&&s.d,c=(i.left-r.left)/(l||1),u=(i.top-r.top)/(a||1);n.animatingX=!!c,n.animatingY=!!u,w(n,"transform","translate3d("+c+"px,"+u+"px,0)"),this.forRepaintDummy=Ao(n),w(n,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),w(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){w(n,"transition",""),w(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},o)}}}}function Ao(t){return t.offsetWidth}function Oo(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}var Mt=[],Je={initializeByDefault:!0},le={mount:function(t){for(var e in Je)Je.hasOwnProperty(e)&&!(e in t)&&(t[e]=Je[e]);Mt.forEach(function(n){if(n.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Mt.push(t)},pluginEvent:function(t,e,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var r=t+"Global";Mt.forEach(function(o){e[o.pluginName]&&(e[o.pluginName][r]&&e[o.pluginName][r](yt({sortable:e},n)),e.options[o.pluginName]&&e[o.pluginName][t]&&e[o.pluginName][t](yt({sortable:e},n)))})},initializePlugins:function(t,e,n,i){Mt.forEach(function(s){var l=s.pluginName;if(!(!t.options[l]&&!s.initializeByDefault)){var a=new s(t,e,t.options);a.sortable=t,a.options=t.options,t[l]=a,St(n,a.defaults)}});for(var r in t.options)if(t.options.hasOwnProperty(r)){var o=this.modifyOption(t,r,t.options[r]);typeof o<"u"&&(t.options[r]=o)}},getEventProperties:function(t,e){var n={};return Mt.forEach(function(i){typeof i.eventProperties=="function"&&St(n,i.eventProperties.call(e[i.pluginName],t))}),n},modifyOption:function(t,e,n){var i;return Mt.forEach(function(r){t[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[e]=="function"&&(i=r.optionListeners[e].call(t[r.pluginName],n))}),i}};function Do(t){var e=t.sortable,n=t.rootEl,i=t.name,r=t.targetEl,o=t.cloneEl,s=t.toEl,l=t.fromEl,a=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,y=t.originalEvent,d=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[st],!!e){var C,$=e.options,P="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!Ct&&!ae?C=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(C=document.createEvent("Event"),C.initEvent(i,!0,!0)),C.to=s||n,C.from=l||n,C.item=r||n,C.clone=o,C.oldIndex=a,C.newIndex=c,C.oldDraggableIndex=u,C.newDraggableIndex=f,C.originalEvent=y,C.pullMode=d?d.lastPutMode:void 0;var J=yt(yt({},g),le.getEventProperties(i,e));for(var k in J)C[k]=J[k];n&&n.dispatchEvent(C),$[P]&&$[P].call(e,C)}}var Ro=["evt"],it=function(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.evt,r=wo(n,Ro);le.pluginEvent.bind(E)(t,e,yt({dragEl:h,parentEl:H,ghostEl:S,rootEl:q,nextEl:It,lastDownEl:ye,cloneEl:V,cloneHidden:kt,dragStarted:Kt,putSortable:G,activeSortable:E.active,originalEvent:i,oldIndex:Ut,oldDraggableIndex:ne,newIndex:ot,newDraggableIndex:xt,hideGhostForTarget:Ui,unhideGhostForTarget:Hi,cloneNowHidden:function(){kt=!0},cloneNowShown:function(){kt=!1},dispatchSortableEvent:function(o){et({sortable:e,name:o,originalEvent:i})}},r))};function et(t){Do(yt({putSortable:G,cloneEl:V,targetEl:h,rootEl:q,oldIndex:Ut,oldDraggableIndex:ne,newIndex:ot,newDraggableIndex:xt},t))}var h,H,S,q,It,ye,V,kt,Ut,ot,ne,xt,de,G,Vt=!1,De=!1,Re=[],Bt,dt,Ge,Ze,di,hi,Kt,qt,ie,re=!1,he=!1,be,Z,tn=[],hn=!1,Be=[],Le=typeof document<"u",fe=Di,fi=ae||Ct?"cssFloat":"float",Bo=Le&&!Ri&&!Di&&"draggable"in document.createElement("div"),qi=(function(){if(Le){if(Ct)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}})(),Vi=function(t,e){var n=w(t),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=$t(t,0,e),o=$t(t,1,e),s=r&&w(r),l=o&&w(o),a=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+z(r).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+z(o).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&s.float!=="none"){var u=s.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===u)?"vertical":"horizontal"}return r&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||a>=i&&n[fi]==="none"||o&&n[fi]==="none"&&a+c>i)?"vertical":"horizontal"},No=function(t,e,n){var i=n?t.left:t.top,r=n?t.right:t.bottom,o=n?t.width:t.height,s=n?e.left:e.top,l=n?e.right:e.bottom,a=n?e.width:e.height;return i===s||r===l||i+o/2===s+a/2},Io=function(t,e){var n;return Re.some(function(i){var r=i[st].options.emptyInsertThreshold;if(!(!r||xn(i))){var o=z(i),s=t>=o.left-r&&t<=o.right+r,l=e>=o.top-r&&e<=o.bottom+r;if(s&&l)return n=i}}),n},Fi=function(t){function e(r,o){return function(s,l,a,c){var u=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(r==null&&(o||u))return!0;if(r==null||r===!1)return!1;if(o&&r==="clone")return r;if(typeof r=="function")return e(r(s,l,a,c),o)(s,l,a,c);var f=(o?s:l).options.group.name;return r===!0||typeof r=="string"&&r===f||r.join&&r.indexOf(f)>-1}}var n={},i=t.group;(!i||ve(i)!="object")&&(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),n.revertClone=i.revertClone,t.group=n},Ui=function(){!qi&&S&&w(S,"display","none")},Hi=function(){!qi&&S&&w(S,"display","")};Le&&!Ri&&document.addEventListener("click",function(t){if(De)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),De=!1,!1},!0);var Nt=function(t){if(h){t=t.touches?t.touches[0]:t;var e=Io(t.clientX,t.clientY);if(e){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[st]._onDragOver(n)}}},Po=function(t){h&&h.parentNode[st]._isOutsideThisEl(t.target)};function E(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=St({},e),t[st]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Vi(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,s){o.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:E.supportPointer!==!1&&"PointerEvent"in window&&!te,emptyInsertThreshold:5};le.initializePlugins(this,t,n);for(var i in n)!(i in e)&&(e[i]=n[i]);Fi(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:Bo,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?B(t,"pointerdown",this._onTapStart):(B(t,"mousedown",this._onTapStart),B(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(B(t,"dragover",this),B(t,"dragenter",this)),Re.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),St(this,ko())}E.prototype={constructor:E,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(qt=null)},_getDirection:function(t,e){return typeof this.options.direction=="function"?this.options.direction.call(this,t,e,h):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,i=this.options,r=i.preventOnFilter,o=t.type,s=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,l=(s||t).target,a=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,c=i.filter;if($o(n),!h&&!(/mousedown|pointerdown/.test(o)&&t.button!==0||i.disabled)&&!a.isContentEditable&&!(!this.nativeDraggable&&te&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=ht(l,i.draggable,n,!1),!(l&&l.animated)&&ye!==l)){if(Ut=at(l),ne=at(l,i.draggable),typeof c=="function"){if(c.call(this,t,l,this)){et({sortable:e,rootEl:a,name:"filter",targetEl:l,toEl:n,fromEl:n}),it("filter",e,{evt:t}),r&&t.cancelable&&t.preventDefault();return}}else if(c&&(c=c.split(",").some(function(u){if(u=ht(a,u.trim(),n,!1),u)return et({sortable:e,rootEl:u,name:"filter",targetEl:l,fromEl:n,toEl:n}),it("filter",e,{evt:t}),!0}),c)){r&&t.cancelable&&t.preventDefault();return}i.handle&&!ht(a,i.handle,n,!1)||this._prepareDragStart(t,s,l)}}},_prepareDragStart:function(t,e,n){var i=this,r=i.el,o=i.options,s=r.ownerDocument,l;if(n&&!h&&n.parentNode===r){var a=z(n);if(q=r,h=n,H=h.parentNode,It=h.nextSibling,ye=n,de=o.group,E.dragged=h,Bt={target:h,clientX:(e||t).clientX,clientY:(e||t).clientY},di=Bt.clientX-a.left,hi=Bt.clientY-a.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,h.style["will-change"]="all",l=function(){if(it("delayEnded",i,{evt:t}),E.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!ai&&i.nativeDraggable&&(h.draggable=!0),i._triggerDragStart(t,e),et({sortable:i,name:"choose",originalEvent:t}),rt(h,o.chosenClass,!0)},o.ignore.split(",").forEach(function(c){Ni(h,c.trim(),en)}),B(s,"dragover",Nt),B(s,"mousemove",Nt),B(s,"touchmove",Nt),B(s,"mouseup",i._onDrop),B(s,"touchend",i._onDrop),B(s,"touchcancel",i._onDrop),ai&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),it("delayStart",this,{evt:t}),o.delay&&(!o.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(ae||Ct))){if(E.eventCanceled){this._onDrop();return}B(s,"mouseup",i._disableDelayedDrag),B(s,"touchend",i._disableDelayedDrag),B(s,"touchcancel",i._disableDelayedDrag),B(s,"mousemove",i._delayedDragTouchMoveHandler),B(s,"touchmove",i._delayedDragTouchMoveHandler),o.supportPointer&&B(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&en(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;D(t,"mouseup",this._disableDelayedDrag),D(t,"touchend",this._disableDelayedDrag),D(t,"touchcancel",this._disableDelayedDrag),D(t,"mousemove",this._delayedDragTouchMoveHandler),D(t,"touchmove",this._delayedDragTouchMoveHandler),D(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||t.pointerType=="touch"&&t,!this.nativeDraggable||e?this.options.supportPointer?B(document,"pointermove",this._onTouchMove):e?B(document,"touchmove",this._onTouchMove):B(document,"mousemove",this._onTouchMove):(B(h,"dragend",this),B(q,"dragstart",this._onDragStart));try{document.selection?_e(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,e){if(Vt=!1,q&&h){it("dragStarted",this,{evt:e}),this.nativeDraggable&&B(document,"dragover",Po);var n=this.options;!t&&rt(h,n.dragClass,!1),rt(h,n.ghostClass,!0),E.active=this,t&&this._appendGhost(),et({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(dt){this._lastX=dt.clientX,this._lastY=dt.clientY,Ui();for(var t=document.elementFromPoint(dt.clientX,dt.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(dt.clientX,dt.clientY),t!==e);)e=t;if(h.parentNode[st]._isOutsideThisEl(t),e)do{if(e[st]){var n=void 0;if(n=e[st]._onDragOver({clientX:dt.clientX,clientY:dt.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);Hi()}},_onTouchMove:function(t){if(Bt){var e=this.options,n=e.fallbackTolerance,i=e.fallbackOffset,r=t.touches?t.touches[0]:t,o=S&&Ht(S,!0),s=S&&o&&o.a,l=S&&o&&o.d,a=fe&&Z&&ui(Z),c=(r.clientX-Bt.clientX+i.x)/(s||1)+(a?a[0]-tn[0]:0)/(s||1),u=(r.clientY-Bt.clientY+i.y)/(l||1)+(a?a[1]-tn[1]:0)/(l||1);if(!E.active&&!Vt){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(S){o?(o.e+=c-(Ge||0),o.f+=u-(Ze||0)):o={a:1,b:0,c:0,d:1,e:c,f:u};var f="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");w(S,"webkitTransform",f),w(S,"mozTransform",f),w(S,"msTransform",f),w(S,"transform",f),Ge=c,Ze=u,dt=r}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!S){var t=this.options.fallbackOnBody?document.body:q,e=z(h,!0,fe,!0,t),n=this.options;if(fe){for(Z=t;w(Z,"position")==="static"&&w(Z,"transform")==="none"&&Z!==document;)Z=Z.parentNode;Z!==document.body&&Z!==document.documentElement?(Z===document&&(Z=gt()),e.top+=Z.scrollTop,e.left+=Z.scrollLeft):Z=gt(),tn=ui(Z)}S=h.cloneNode(!0),rt(S,n.ghostClass,!1),rt(S,n.fallbackClass,!0),rt(S,n.dragClass,!0),w(S,"transition",""),w(S,"transform",""),w(S,"box-sizing","border-box"),w(S,"margin",0),w(S,"top",e.top),w(S,"left",e.left),w(S,"width",e.width),w(S,"height",e.height),w(S,"opacity","0.8"),w(S,"position",fe?"absolute":"fixed"),w(S,"zIndex","100000"),w(S,"pointerEvents","none"),E.ghost=S,t.appendChild(S),w(S,"transform-origin",di/parseInt(S.style.width)*100+"% "+hi/parseInt(S.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,i=t.dataTransfer,r=n.options;if(it("dragStart",this,{evt:t}),E.eventCanceled){this._onDrop();return}it("setupClone",this),E.eventCanceled||(V=Li(h),V.removeAttribute("id"),V.draggable=!1,V.style["will-change"]="",this._hideClone(),rt(V,this.options.chosenClass,!1),E.clone=V),n.cloneId=_e(function(){it("clone",n),!E.eventCanceled&&(n.options.removeCloneOnHide||q.insertBefore(V,h),n._hideClone(),et({sortable:n,name:"clone"}))}),!e&&rt(h,r.dragClass,!0),e?(De=!0,n._loopId=setInterval(n._emulateDragOver,50)):(D(document,"mouseup",n._onDrop),D(document,"touchend",n._onDrop),D(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",r.setData&&r.setData.call(n,i,h)),B(document,"drop",n),w(h,"transform","translateZ(0)")),Vt=!0,n._dragStartId=_e(n._dragStarted.bind(n,e,t)),B(document,"selectstart",n),Kt=!0,te&&w(document.body,"user-select","none")},_onDragOver:function(t){var e=this.el,n=t.target,i,r,o,s=this.options,l=s.group,a=E.active,c=de===l,u=s.sort,f=G||a,y,d=this,g=!1;if(hn)return;function C(Y,_t){it(Y,d,yt({evt:t,isOwner:c,axis:y?"vertical":"horizontal",revert:o,dragRect:i,targetRect:r,canSort:u,fromSortable:f,target:n,completed:P,onMove:function(pt,Yt){return pe(q,e,h,i,pt,z(pt),t,Yt)},changed:J},_t))}function $(){C("dragOverAnimationCapture"),d.captureAnimationState(),d!==f&&f.captureAnimationState()}function P(Y){return C("dragOverCompleted",{insertion:Y}),Y&&(c?a._hideClone():a._showClone(d),d!==f&&(rt(h,G?G.options.ghostClass:a.options.ghostClass,!1),rt(h,s.ghostClass,!0)),G!==d&&d!==E.active?G=d:d===E.active&&G&&(G=null),f===d&&(d._ignoreWhileAnimating=n),d.animateAll(function(){C("dragOverAnimationComplete"),d._ignoreWhileAnimating=null}),d!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(n===h&&!h.animated||n===e&&!n.animated)&&(qt=null),!s.dragoverBubble&&!t.rootEl&&n!==document&&(h.parentNode[st]._isOutsideThisEl(t.target),!Y&&Nt(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),g=!0}function J(){ot=at(h),xt=at(h,s.draggable),et({sortable:d,name:"change",toEl:e,newIndex:ot,newDraggableIndex:xt,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),n=ht(n,s.draggable,e,!0),C("dragOver"),E.eventCanceled)return g;if(h.contains(t.target)||n.animated&&n.animatingX&&n.animatingY||d._ignoreWhileAnimating===n)return P(!1);if(De=!1,a&&!s.disabled&&(c?u||(o=H!==q):G===this||(this.lastPutMode=de.checkPull(this,a,h,t))&&l.checkPut(this,a,h,t))){if(y=this._getDirection(t,n)==="vertical",i=z(h),C("dragOverValid"),E.eventCanceled)return g;if(o)return H=q,$(),this._hideClone(),C("revert"),E.eventCanceled||(It?q.insertBefore(h,It):q.appendChild(h)),P(!0);var k=xn(e,s.draggable);if(!k||Vo(t,y,this)&&!k.animated){if(k===h)return P(!1);if(k&&e===t.target&&(n=k),n&&(r=z(n)),pe(q,e,h,i,n,r,t,!!n)!==!1)return $(),k&&k.nextSibling?e.insertBefore(h,k.nextSibling):e.appendChild(h),H=e,J(),P(!0)}else if(k&&qo(t,y,this)){var W=$t(e,0,s,!0);if(W===h)return P(!1);if(n=W,r=z(n),pe(q,e,h,i,n,r,t,!1)!==!1)return $(),e.insertBefore(h,W),H=e,J(),P(!0)}else if(n.parentNode===e){r=z(n);var O=0,K,L=h.parentNode!==e,X=!No(h.animated&&h.toRect||i,n.animated&&n.toRect||r,y),M=y?"top":"left",b=ci(n,"top","top")||ci(h,"top","top"),p=b?b.scrollTop:void 0;qt!==n&&(K=r[M],re=!1,he=!X&&s.invertSwap||L),O=Fo(t,n,r,y,X?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,he,qt===n);var v;if(O!==0){var m=at(h);do m-=O,v=H.children[m];while(v&&(w(v,"display")==="none"||v===S))}if(O===0||v===n)return P(!1);qt=n,ie=O;var _=n.nextElementSibling,I=!1;I=O===1;var F=pe(q,e,h,i,n,r,t,I);if(F!==!1)return(F===1||F===-1)&&(I=F===1),hn=!0,setTimeout(Mo,30),$(),I&&!_?e.appendChild(h):n.parentNode.insertBefore(h,I?_:n),b&&Pi(b,0,p-b.scrollTop),H=h.parentNode,K!==void 0&&!he&&(be=Math.abs(K-z(n)[M])),J(),P(!0)}if(e.contains(h))return P(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){D(document,"mousemove",this._onTouchMove),D(document,"touchmove",this._onTouchMove),D(document,"pointermove",this._onTouchMove),D(document,"dragover",Nt),D(document,"mousemove",Nt),D(document,"touchmove",Nt)},_offUpEvents:function(){var t=this.el.ownerDocument;D(t,"mouseup",this._onDrop),D(t,"touchend",this._onDrop),D(t,"pointerup",this._onDrop),D(t,"touchcancel",this._onDrop),D(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;if(ot=at(h),xt=at(h,n.draggable),it("drop",this,{evt:t}),H=h&&h.parentNode,ot=at(h),xt=at(h,n.draggable),E.eventCanceled){this._nulling();return}Vt=!1,he=!1,re=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),fn(this.cloneId),fn(this._dragStartId),this.nativeDraggable&&(D(document,"drop",this),D(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),te&&w(document.body,"user-select",""),w(h,"transform",""),t&&(Kt&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),S&&S.parentNode&&S.parentNode.removeChild(S),(q===H||G&&G.lastPutMode!=="clone")&&V&&V.parentNode&&V.parentNode.removeChild(V),h&&(this.nativeDraggable&&D(h,"dragend",this),en(h),h.style["will-change"]="",Kt&&!Vt&&rt(h,G?G.options.ghostClass:this.options.ghostClass,!1),rt(h,this.options.chosenClass,!1),et({sortable:this,name:"unchoose",toEl:H,newIndex:null,newDraggableIndex:null,originalEvent:t}),q!==H?(ot>=0&&(et({rootEl:H,name:"add",toEl:H,fromEl:q,originalEvent:t}),et({sortable:this,name:"remove",toEl:H,originalEvent:t}),et({rootEl:H,name:"sort",toEl:H,fromEl:q,originalEvent:t}),et({sortable:this,name:"sort",toEl:H,originalEvent:t})),G&&G.save()):ot!==Ut&&ot>=0&&(et({sortable:this,name:"update",toEl:H,originalEvent:t}),et({sortable:this,name:"sort",toEl:H,originalEvent:t})),E.active&&((ot==null||ot===-1)&&(ot=Ut,xt=ne),et({sortable:this,name:"end",toEl:H,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){it("nulling",this),q=h=H=S=It=V=ye=kt=Bt=dt=Kt=ot=xt=Ut=ne=qt=ie=G=de=E.dragged=E.ghost=E.clone=E.active=null,Be.forEach(function(t){t.checked=!0}),Be.length=Ge=Ze=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":h&&(this._onDragOver(t),Lo(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],e,n=this.el.children,i=0,r=n.length,o=this.options;i<r;i++)e=n[i],ht(e,o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||Ho(e));return t},sort:function(t,e){var n={},i=this.el;this.toArray().forEach(function(r,o){var s=i.children[o];ht(s,this.options.draggable,i,!1)&&(n[r]=s)},this),e&&this.captureAnimationState(),t.forEach(function(r){n[r]&&(i.removeChild(n[r]),i.appendChild(n[r]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return ht(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(e===void 0)return n[t];var i=le.modifyOption(this,t,e);typeof i<"u"?n[t]=i:n[t]=e,t==="group"&&Fi(n)},destroy:function(){it("destroy",this);var t=this.el;t[st]=null,D(t,"mousedown",this._onTapStart),D(t,"touchstart",this._onTapStart),D(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(D(t,"dragover",this),D(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Re.splice(Re.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!kt){if(it("hideClone",this),E.eventCanceled)return;w(V,"display","none"),this.options.removeCloneOnHide&&V.parentNode&&V.parentNode.removeChild(V),kt=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(kt){if(it("showClone",this),E.eventCanceled)return;h.parentNode==q&&!this.options.group.revertClone?q.insertBefore(V,h):It?q.insertBefore(V,It):q.appendChild(V),this.options.group.revertClone&&this.animate(h,V),w(V,"display",""),kt=!1}}};function Lo(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function pe(t,e,n,i,r,o,s,l){var a,c=t[st],u=c.options.onMove,f;return window.CustomEvent&&!Ct&&!ae?a=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(a=document.createEvent("Event"),a.initEvent("move",!0,!0)),a.to=e,a.from=t,a.dragged=n,a.draggedRect=i,a.related=r||e,a.relatedRect=o||z(e),a.willInsertAfter=l,a.originalEvent=s,t.dispatchEvent(a),u&&(f=u.call(c,a,s)),f}function en(t){t.draggable=!1}function Mo(){hn=!1}function qo(t,e,n){var i=z($t(n.el,0,n.options,!0)),r=Mi(n.el,n.options,S),o=10;return e?t.clientX<r.left-o||t.clientY<i.top&&t.clientX<i.right:t.clientY<r.top-o||t.clientY<i.bottom&&t.clientX<i.left}function Vo(t,e,n){var i=z(xn(n.el,n.options.draggable)),r=Mi(n.el,n.options,S),o=10;return e?t.clientX>r.right+o||t.clientY>i.bottom&&t.clientX>i.left:t.clientY>r.bottom+o||t.clientX>i.right&&t.clientY>i.top}function Fo(t,e,n,i,r,o,s,l){var a=i?t.clientY:t.clientX,c=i?n.height:n.width,u=i?n.top:n.left,f=i?n.bottom:n.right,y=!1;if(!s){if(l&&be<c*r){if(!re&&(ie===1?a>u+c*o/2:a<f-c*o/2)&&(re=!0),re)y=!0;else if(ie===1?a<u+be:a>f-be)return-ie}else if(a>u+c*(1-r)/2&&a<f-c*(1-r)/2)return Uo(e)}return y=y||s,y&&(a<u+c*o/2||a>f-c*o/2)?a>u+c/2?1:-1:0}function Uo(t){return at(h)<at(t)?1:-1}function Ho(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function $o(t){Be.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var i=e[n];i.checked&&Be.push(i)}}function _e(t){return setTimeout(t,0)}function fn(t){return clearTimeout(t)}Le&&B(document,"touchmove",function(t){(E.active||Vt)&&t.cancelable&&t.preventDefault()});E.utils={on:B,off:D,css:w,find:Ni,is:function(t,e){return!!ht(t,e,t,!1)},extend:To,throttle:Ii,closest:ht,toggleClass:rt,clone:Li,index:at,nextTick:_e,cancelNextTick:fn,detectDirection:Vi,getChild:$t};E.get=function(t){return t[st]};E.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(E.utils=yt(yt({},E.utils),i.utils)),le.mount(i)})};E.create=function(t,e){return new E(t,e)};E.version=Eo;var j=[],Jt,pn,mn=!1,nn,rn,Ne,Gt;function Wo(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(e){var n=e.originalEvent;this.sortable.nativeDraggable?B(document,"dragover",this._handleAutoScroll):this.options.supportPointer?B(document,"pointermove",this._handleFallbackAutoScroll):n.touches?B(document,"touchmove",this._handleFallbackAutoScroll):B(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var n=e.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?D(document,"dragover",this._handleAutoScroll):(D(document,"pointermove",this._handleFallbackAutoScroll),D(document,"touchmove",this._handleFallbackAutoScroll),D(document,"mousemove",this._handleFallbackAutoScroll)),pi(),we(),xo()},nulling:function(){Ne=pn=Jt=mn=Gt=nn=rn=null,j.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,n){var i=this,r=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,s=document.elementFromPoint(r,o);if(Ne=e,n||this.options.forceAutoScrollFallback||ae||Ct||te){on(e,this.options,s,n);var l=At(s,!0);mn&&(!Gt||r!==nn||o!==rn)&&(Gt&&pi(),Gt=setInterval(function(){var a=At(document.elementFromPoint(r,o),!0);a!==l&&(l=a,we()),on(e,i.options,a,n)},10),nn=r,rn=o)}else{if(!this.options.bubbleScroll||At(s,!0)===gt()){we();return}on(e,this.options,At(s,!1),!1)}}},St(t,{pluginName:"scroll",initializeByDefault:!0})}function we(){j.forEach(function(t){clearInterval(t.pid)}),j=[]}function pi(){clearInterval(Gt)}var on=Ii(function(t,e,n,i){if(e.scroll){var r=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,a=gt(),c=!1,u;pn!==n&&(pn=n,we(),Jt=e.scroll,u=e.scrollFn,Jt===!0&&(Jt=At(n,!0)));var f=0,y=Jt;do{var d=y,g=z(d),C=g.top,$=g.bottom,P=g.left,J=g.right,k=g.width,W=g.height,O=void 0,K=void 0,L=d.scrollWidth,X=d.scrollHeight,M=w(d),b=d.scrollLeft,p=d.scrollTop;d===a?(O=k<L&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),K=W<X&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(O=k<L&&(M.overflowX==="auto"||M.overflowX==="scroll"),K=W<X&&(M.overflowY==="auto"||M.overflowY==="scroll"));var v=O&&(Math.abs(J-r)<=s&&b+k<L)-(Math.abs(P-r)<=s&&!!b),m=K&&(Math.abs($-o)<=s&&p+W<X)-(Math.abs(C-o)<=s&&!!p);if(!j[f])for(var _=0;_<=f;_++)j[_]||(j[_]={});(j[f].vx!=v||j[f].vy!=m||j[f].el!==d)&&(j[f].el=d,j[f].vx=v,j[f].vy=m,clearInterval(j[f].pid),(v!=0||m!=0)&&(c=!0,j[f].pid=setInterval((function(){i&&this.layer===0&&E.active._onTouchMove(Ne);var I=j[this.layer].vy?j[this.layer].vy*l:0,F=j[this.layer].vx?j[this.layer].vx*l:0;typeof u=="function"&&u.call(E.dragged.parentNode[st],F,I,t,Ne,j[this.layer].el)!=="continue"||Pi(j[this.layer].el,F,I)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&y!==a&&(y=At(y,!1)));mn=c}},30),$i=function(t){var e=t.originalEvent,n=t.putSortable,i=t.dragEl,r=t.activeSortable,o=t.dispatchSortableEvent,s=t.hideGhostForTarget,l=t.unhideGhostForTarget;if(e){var a=n||r;s();var c=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,u=document.elementFromPoint(c.clientX,c.clientY);l(),a&&!a.el.contains(u)&&(o("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function kn(){}kn.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=$t(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(e,i):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:$i};St(kn,{pluginName:"revertOnSpill"});function An(){}An.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,i=n||this.sortable;i.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),i.animateAll()},drop:$i};St(An,{pluginName:"removeOnSpill"});E.mount(new Wo);E.mount(An,kn);function Yo(t){return t==null?t:JSON.parse(JSON.stringify(t))}function Xo(t){se()&&Sr(t)}function jo(t){se()?Cn(t):Sn(t)}let Wi=null,Yi=null;function mi(t=null,e=null){Wi=t,Yi=e}function zo(){return{data:Wi,clonedData:Yi}}const gi=Symbol("cloneElement");function Qo(...t){var e,n;const i=(e=se())==null?void 0:e.proxy;let r=null;const o=t[0];let[,s,l]=t;Array.isArray(N(s))||(l=s,s=null);let a=null;const{immediate:c=!0,clone:u=Yo,forceFallback:f,fallbackOnBody:y,customUpdate:d}=(n=N(l))!=null?n:{};function g(b){var p;const{from:v,oldIndex:m,item:_}=b,I=Array.from(v.childNodes);r=f&&!y?I.slice(0,-1):I;const F=N((p=N(s))==null?void 0:p[m]),Y=u(F);mi(F,Y),_[gi]=Y}function C(b){const p=b.item[gi];if(!uo(p)){if(Qe(b.item),Ue(s)){const v=[...N(s)];s.value=ii(v,b.newDraggableIndex,p);return}ii(N(s),b.newDraggableIndex,p)}}function $(b){const{from:p,item:v,oldIndex:m,oldDraggableIndex:_,pullMode:I,clone:F}=b;if(ri(p,v,m),I==="clone"){Qe(F);return}if(Ue(s)){const Y=[...N(s)];s.value=ni(Y,_);return}ni(N(s),_)}function P(b){if(d){d(b);return}const{from:p,item:v,oldIndex:m,oldDraggableIndex:_,newDraggableIndex:I}=b;if(Qe(v),ri(p,v,m),Ue(s)){const F=[...N(s)];s.value=ei(F,_,I);return}ei(N(s),_,I)}function J(b){const{newIndex:p,oldIndex:v,from:m,to:_}=b;let I=null;const F=p===v&&m===_;try{if(F){let Y=null;r?.some((_t,pt)=>{if(Y&&r?.length!==_.childNodes.length)return m.insertBefore(Y,_t.nextSibling),!0;const Yt=_.childNodes[pt];Y=_?.replaceChild(_t,Yt)})}}catch(Y){I=Y}finally{r=null}Sn(()=>{if(mi(),I)throw I})}const k={onUpdate:P,onStart:g,onAdd:C,onRemove:$,onEnd:J};function W(b){const p=N(o);return b||(b=ho(p)?fo(p,i?.$el):p),b&&!go(b)&&(b=b.$el),b||ao("Root element not found"),b}function O(){var b;const p=(b=N(l))!=null?b:{},{immediate:v,clone:m}=p,_=Ai(p,["immediate","clone"]);return oi(_,(I,F)=>{vo(I)&&(_[I]=(Y,..._t)=>{const pt=zo();return yo(Y,pt),F(Y,..._t)})}),mo(s===null?{}:k,_)}const K=b=>{b=W(b),a&&L.destroy(),a=new E(b,O())};Ot(()=>l,()=>{a&&oi(O(),(b,p)=>{a?.option(b,p)})},{deep:!0});const L={option:(b,p)=>a?.option(b,p),destroy:()=>{a?.destroy(),a=null},save:()=>a?.save(),toArray:()=>a?.toArray(),closest:(...b)=>a?.closest(...b)},X=()=>L?.option("disabled",!0),M=()=>L?.option("disabled",!1);return jo(()=>{c&&K()}),Xo(L.destroy),Ft({start:K,pause:X,resume:M},L)}const gn=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],Ko=["clone","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target","customUpdate",...gn.map(t=>`on${t.replace(/^\S/,e=>e.toUpperCase())}`)],vi=Si({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:Ko,emits:["update:modelValue",...gn],setup(t,{slots:e,emit:n,expose:i,attrs:r}){const o=gn.reduce((u,f)=>{const y=`on${f.replace(/^\S/,d=>d.toUpperCase())}`;return u[y]=(...d)=>n(f,...d),u},{}),s=mt(()=>{const u=Er(t),{modelValue:f}=u,y=Ai(u,["modelValue"]),d=Object.entries(y).reduce((g,[C,$])=>{const P=N($);return P!==void 0&&(g[C]=P),g},{});return Ft(Ft({},o),co(Ft(Ft({},r),d)))}),l=mt({get:()=>t.modelValue,set:u=>n("update:modelValue",u)}),a=lt(),c=Ci(Qo(t.target||a,l,s));return i(c),()=>{var u;return un(t.tag||"div",{ref:a},(u=e?.default)==null?void 0:u.call(e,c))}}}),Xi=Tn("board",{state:()=>({boardId:null,board:null,lists:[],cardsByListId:{},loading:!1,error:null}),getters:{isLoaded:t=>!!t.boardId&&!!t.board},actions:{clear(){this.boardId=null,this.board=null,this.lists=[],this.cardsByListId={},this.loading=!1,this.error=null},async load(t){this.loading=!0,this.error=null,this.boardId=t;try{const e=await nt(`/boards/${t}`),n=await nt(`/boards/${t}/lists`),i=await Promise.all(n.map(async r=>{const o=await nt(`/lists/${r.id}/cards`);return[r.id,o.cards]}));this.board=e,this.lists=n,this.cardsByListId=Object.fromEntries(i)}catch(e){this.error=oe(e,"Failed to load board")}finally{this.loading=!1}},async refresh(){this.boardId&&await this.load(this.boardId)},async addList(t){if(!this.boardId)return;const e=await nt(`/boards/${this.boardId}/lists`,{method:"POST",body:{title:t}});this.lists=[...this.lists,e.list].sort((n,i)=>n.position-i.position),this.cardsByListId[e.list.id]=[]},async updateList(t,e){if(!this.boardId)return;const n=await nt(`/boards/${this.boardId}/lists/${t}`,{method:"PATCH",body:e});this.lists=this.lists.map(i=>i.id===t?n.list:i),this.lists.sort((i,r)=>i.position-r.position)},async deleteList(t){this.boardId&&(await nt(`/boards/${this.boardId}/lists/${t}`,{method:"DELETE"}),this.lists=this.lists.filter(e=>e.id!==t),delete this.cardsByListId[t])},async reorderLists(t){if(!this.boardId)return;const e=await nt(`/boards/${this.boardId}/reorder-lists`,{method:"POST",body:{listIds:t}}),n=new Map(this.lists.map(i=>[i.id,i]));this.lists=e.listIds.map(i=>n.get(i)).filter(Boolean)},async addCard(t,e){const n=await nt(`/lists/${t}/cards`,{method:"POST",body:{title:e}}),i=this.cardsByListId[t]??[];this.cardsByListId[t]=[...i,n.card].sort((r,o)=>r.position-o.position)},async patchCard(t,e){const n=await nt(`/cards/${t}`,{method:"PATCH",body:e}),i=n.card.listId,r=this.cardsByListId[i]??[];this.cardsByListId[i]=r.map(o=>o.id===t?n.card:o)},async deleteCard(t,e){await nt(`/cards/${t}`,{method:"DELETE"});const n=this.cardsByListId[e]??[];this.cardsByListId[e]=n.filter(i=>i.id!==t)},async moveCard(t,e,n){const i=await nt(`/cards/${t}/move`,{method:"POST",body:{toListId:e,toIndex:n}});return await this.refresh(),i.card}}}),Jo=Object.freeze(Object.defineProperty({__proto__:null,useBoardStore:Xi},Symbol.toStringTag,{value:"Module"})),ji=Tn("activity",{state:()=>({boardId:null,events:[],nextCursor:null,loading:!1,error:null}),actions:{clearLocal(){this.boardId=null,this.events=[],this.nextCursor=null,this.loading=!1,this.error=null},prepend(t){this.events.find(e=>e.id===t.id)||(this.events=[t,...this.events])},async loadRecent(t){this.loading=!0,this.error=null,this.boardId=t;try{const e=await nt(`/boards/${t}/activity?limit=50`);this.events=e.events,this.nextCursor=e.nextCursor}catch(e){this.error=oe(e,"Failed to load activity")}finally{this.loading=!1}},async loadMore(){if(!(!this.boardId||!this.nextCursor)){this.loading=!0,this.error=null;try{const t=await nt(`/boards/${this.boardId}/activity?limit=50&cursor=${encodeURIComponent(this.nextCursor)}`),e=new Set(this.events.map(n=>n.id));this.events=[...this.events,...t.events.filter(n=>!e.has(n.id))],this.nextCursor=t.nextCursor}catch(t){this.error=oe(t,"Failed to load more activity")}finally{this.loading=!1}}},async undo(t){const e=await nt(`/activity/${t}/undo`,{method:"POST"});this.prepend(e.activityEvent);const n=this.events.findIndex(i=>i.id===t);if(n>=0){const i=this.events[n];i&&(this.events[n]={...i,undoneAt:new Date().toISOString()})}return e.activityEvent},async clearServer(t){await nt(`/boards/${t}/activity/clear`,{method:"POST"}),this.boardId===t&&(this.events=[],this.nextCursor=null)}}}),yi=Object.freeze(Object.defineProperty({__proto__:null,useActivityStore:ji},Symbol.toStringTag,{value:"Module"})),bt=Object.create(null);bt.open="0";bt.close="1";bt.ping="2";bt.pong="3";bt.message="4";bt.upgrade="5";bt.noop="6";const Ee=Object.create(null);Object.keys(bt).forEach(t=>{Ee[bt[t]]=t});const vn={type:"error",data:"parser error"},zi=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Qi=typeof ArrayBuffer=="function",Ki=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,On=({type:t,data:e},n,i)=>zi&&e instanceof Blob?n?i(e):bi(e,i):Qi&&(e instanceof ArrayBuffer||Ki(e))?n?i(e):bi(new Blob([e]),i):i(bt[t]+(e||"")),bi=(t,e)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];e("b"+(i||""))},n.readAsDataURL(t)};function _i(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let sn;function Go(t,e){if(zi&&t.data instanceof Blob)return t.data.arrayBuffer().then(_i).then(e);if(Qi&&(t.data instanceof ArrayBuffer||Ki(t.data)))return e(_i(t.data));On(t,!1,n=>{sn||(sn=new TextEncoder),e(sn.encode(n))})}const wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<wi.length;t++)Zt[wi.charCodeAt(t)]=t;const Zo=t=>{let e=t.length*.75,n=t.length,i,r=0,o,s,l,a;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(i=0;i<n;i+=4)o=Zt[t.charCodeAt(i)],s=Zt[t.charCodeAt(i+1)],l=Zt[t.charCodeAt(i+2)],a=Zt[t.charCodeAt(i+3)],u[r++]=o<<2|s>>4,u[r++]=(s&15)<<4|l>>2,u[r++]=(l&3)<<6|a&63;return c},ts=typeof ArrayBuffer=="function",Dn=(t,e)=>{if(typeof t!="string")return{type:"message",data:Ji(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:es(t.substring(1),e)}:Ee[n]?t.length>1?{type:Ee[n],data:t.substring(1)}:{type:Ee[n]}:vn},es=(t,e)=>{if(ts){const n=Zo(t);return Ji(n,e)}else return{base64:!0,data:t}},Ji=(t,e)=>e==="blob"?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,Gi="",ns=(t,e)=>{const n=t.length,i=new Array(n);let r=0;t.forEach((o,s)=>{On(o,!1,l=>{i[s]=l,++r===n&&e(i.join(Gi))})})},is=(t,e)=>{const n=t.split(Gi),i=[];for(let r=0;r<n.length;r++){const o=Dn(n[r],e);if(i.push(o),o.type==="error")break}return i};function rs(){return new TransformStream({transform(t,e){Go(t,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,i)}else{r=new Uint8Array(9);const o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(i))}t.data&&typeof t.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(n)})}})}let an;function me(t){return t.reduce((e,n)=>e+n.length,0)}function ge(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let i=0;for(let r=0;r<e;r++)n[r]=t[0][i++],i===t[0].length&&(t.shift(),i=0);return t.length&&i<t[0].length&&(t[0]=t[0].slice(i)),n}function os(t,e){an||(an=new TextDecoder);const n=[];let i=0,r=-1,o=!1;return new TransformStream({transform(s,l){for(n.push(s);;){if(i===0){if(me(n)<1)break;const a=ge(n,1);o=(a[0]&128)===128,r=a[0]&127,r<126?i=3:r===126?i=1:i=2}else if(i===1){if(me(n)<2)break;const a=ge(n,2);r=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),i=3}else if(i===2){if(me(n)<8)break;const a=ge(n,8),c=new DataView(a.buffer,a.byteOffset,a.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){l.enqueue(vn);break}r=u*Math.pow(2,32)+c.getUint32(4),i=3}else{if(me(n)<r)break;const a=ge(n,r);l.enqueue(Dn(o?a:an.decode(a),e)),i=0}if(r===0||r>t){l.enqueue(vn);break}}}})}const Zi=4;function Q(t){if(t)return ss(t)}function ss(t){for(var e in Q.prototype)t[e]=Q.prototype[e];return t}Q.prototype.on=Q.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Q.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};Q.prototype.off=Q.prototype.removeListener=Q.prototype.removeAllListeners=Q.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===e||i.fn===e){n.splice(r,1);break}return n.length===0&&delete this._callbacks["$"+t],this};Q.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,e)}return this};Q.prototype.emitReserved=Q.prototype.emit;Q.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Q.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Me=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),ct=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),as="arraybuffer";function tr(t,...e){return e.reduce((n,i)=>(t.hasOwnProperty(i)&&(n[i]=t[i]),n),{})}const ls=ct.setTimeout,cs=ct.clearTimeout;function qe(t,e){e.useNativeTimers?(t.setTimeoutFn=ls.bind(ct),t.clearTimeoutFn=cs.bind(ct)):(t.setTimeoutFn=ct.setTimeout.bind(ct),t.clearTimeoutFn=ct.clearTimeout.bind(ct))}const us=1.33;function ds(t){return typeof t=="string"?hs(t):Math.ceil((t.byteLength||t.size)*us)}function hs(t){let e=0,n=0;for(let i=0,r=t.length;i<r;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}function er(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function fs(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function ps(t){let e={},n=t.split("&");for(let i=0,r=n.length;i<r;i++){let o=n[i].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}class ms extends Error{constructor(e,n,i){super(e),this.description=n,this.context=i,this.type="TransportError"}}class Rn extends Q{constructor(e){super(),this.writable=!1,qe(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,i){return super.emitReserved("error",new ms(e,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=Dn(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=fs(e);return n.length?"?"+n:""}}class gs extends Rn{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};is(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,ns(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=er()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let nr=!1;try{nr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const vs=nr;function ys(){}class bs extends gs{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,n){const i=this.request({method:"POST",data:e});i.on("success",n),i.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=e}}class vt extends Q{constructor(e,n,i){super(),this.createRequest=e,qe(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const n=tr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&i.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var r;i.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=vt.requestsCount++,vt.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ys,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete vt.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}vt.requestsCount=0;vt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ei);else if(typeof addEventListener=="function"){const t="onpagehide"in ct?"pagehide":"unload";addEventListener(t,Ei,!1)}}function Ei(){for(let t in vt.requests)vt.requests.hasOwnProperty(t)&&vt.requests[t].abort()}const _s=(function(){const t=ir({xdomain:!1});return t&&t.responseType!==null})();class ws extends bs{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=_s&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new vt(ir,this.uri(),e)}}function ir(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||vs))return new XMLHttpRequest}catch{}if(!e)try{return new ct[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const rr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Es extends Rn{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,i=rr?{}:tr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const i=e[n],r=n===e.length-1;On(i,this.supportsBinary,o=>{try{this.doWrite(i,o)}catch{}r&&Me(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=er()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const ln=ct.WebSocket||ct.MozWebSocket;class Ss extends Es{createSocket(e,n,i){return rr?new ln(e,n,i):n?new ln(e,n):new ln(e)}doWrite(e,n){this.ws.send(n)}}class Cs extends Rn{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=os(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(n).getReader(),r=rs();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const o=()=>{i.read().then(({done:l,value:a})=>{l||(this.onPacket(a),o())}).catch(l=>{})};o();const s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const i=e[n],r=n===e.length-1;this._writer.write(i).then(()=>{r&&Me(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Ts={websocket:Ss,webtransport:Cs,polling:ws},xs=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ks=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function yn(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),i=t.indexOf("]");n!=-1&&i!=-1&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));let r=xs.exec(t||""),o={},s=14;for(;s--;)o[ks[s]]=r[s]||"";return n!=-1&&i!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=As(o,o.path),o.queryKey=Os(o,o.query),o}function As(t,e){const n=/\/{2,9}/g,i=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Os(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,o){r&&(n[r]=o)}),n}const bn=typeof addEventListener=="function"&&typeof removeEventListener=="function",Se=[];bn&&addEventListener("offline",()=>{Se.forEach(t=>t())},!1);class Dt extends Q{constructor(e,n){if(super(),this.binaryType=as,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const i=yn(e);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=yn(n.host).host);qe(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const r=i.prototype.name;this.transports.push(r),this._transportsByName[r]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ps(this.opts.query)),bn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Se.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=Zi,n.transport=e,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Dt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Dt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const r=this.writeBuffer[i].data;if(r&&(n+=ds(r)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Me(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,i){return this._sendPacket("message",e,n,i),this}send(e,n,i){return this._sendPacket("message",e,n,i),this}_sendPacket(e,n,i,r){if(typeof n=="function"&&(r=n,n=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const o={type:e,data:n,options:i};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(Dt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),bn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=Se.indexOf(this._offlineEventListener);i!==-1&&Se.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}Dt.protocol=Zi;class Ds extends Dt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),i=!1;Dt.priorWebsocketSuccess=!1;const r=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",f=>{if(!i)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Dt.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const y=new Error("probe error");y.transport=n.name,this.emitReserved("upgradeError",y)}}))};function o(){i||(i=!0,u(),n.close(),n=null)}const s=f=>{const y=new Error("probe error: "+f);y.transport=n.name,o(),this.emitReserved("upgradeError",y)};function l(){s("transport closed")}function a(){s("socket closed")}function c(f){n&&f.name!==n.name&&o()}const u=()=>{n.removeListener("open",r),n.removeListener("error",s),n.removeListener("close",l),this.off("close",a),this.off("upgrading",c)};n.once("open",r),n.once("error",s),n.once("close",l),this.once("close",a),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&n.push(e[i]);return n}}let Rs=class extends Ds{constructor(e,n={}){const i=typeof e=="object"?e:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(r=>Ts[r]).filter(r=>!!r)),super(e,i)}};function Bs(t,e="",n){let i=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),i=yn(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const o=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+e,i.href=i.protocol+"://"+o+(n&&n.port===i.port?"":":"+i.port),i}const Ns=typeof ArrayBuffer=="function",Is=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,or=Object.prototype.toString,Ps=typeof Blob=="function"||typeof Blob<"u"&&or.call(Blob)==="[object BlobConstructor]",Ls=typeof File=="function"||typeof File<"u"&&or.call(File)==="[object FileConstructor]";function Bn(t){return Ns&&(t instanceof ArrayBuffer||Is(t))||Ps&&t instanceof Blob||Ls&&t instanceof File}function Ce(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,i=t.length;n<i;n++)if(Ce(t[n]))return!0;return!1}if(Bn(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ce(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Ce(t[n]))return!0;return!1}function Ms(t){const e=[],n=t.data,i=t;return i.data=_n(n,e),i.attachments=e.length,{packet:i,buffers:e}}function _n(t,e){if(!t)return t;if(Bn(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=_n(t[i],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=_n(t[i],e));return n}return t}function qs(t,e){return t.data=wn(t.data,e),delete t.attachments,t}function wn(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=wn(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=wn(t[n],e));return t}const sr=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Vs=5;var T;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(T||(T={}));class Fs{constructor(e){this.replacer=e}encode(e){return(e.type===T.EVENT||e.type===T.ACK)&&Ce(e)?this.encodeAsBinary({type:e.type===T.EVENT?T.BINARY_EVENT:T.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===T.BINARY_EVENT||e.type===T.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=Ms(e),i=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(i),r}}class Nn extends Q{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const i=n.type===T.BINARY_EVENT;i||n.type===T.BINARY_ACK?(n.type=i?T.EVENT:T.ACK,this.reconstructor=new Us(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Bn(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const i={type:Number(e.charAt(0))};if(T[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===T.BINARY_EVENT||i.type===T.BINARY_ACK){const o=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const s=e.substring(o,n);if(s!=Number(s)||e.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(s)}if(e.charAt(n+1)==="/"){const o=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););i.nsp=e.substring(o,n)}else i.nsp="/";const r=e.charAt(n+1);if(r!==""&&Number(r)==r){const o=n+1;for(;++n;){const s=e.charAt(n);if(s==null||Number(s)!=s){--n;break}if(n===e.length)break}i.id=Number(e.substring(o,n+1))}if(e.charAt(++n)){const o=this.tryParse(e.substr(n));if(Nn.isPayloadValid(i.type,o))i.data=o;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case T.CONNECT:return Ie(n);case T.DISCONNECT:return n===void 0;case T.CONNECT_ERROR:return typeof n=="string"||Ie(n);case T.EVENT:case T.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&sr.indexOf(n[0])===-1);case T.ACK:case T.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Us{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=qs(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Hs(t){return typeof t=="string"}const $s=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};function Ws(t){return t===void 0||$s(t)}function Ie(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ys(t,e){switch(t){case T.CONNECT:return e===void 0||Ie(e);case T.DISCONNECT:return e===void 0;case T.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&sr.indexOf(e[0])===-1);case T.ACK:return Array.isArray(e);case T.CONNECT_ERROR:return typeof e=="string"||Ie(e);default:return!1}}function Xs(t){return Hs(t.nsp)&&Ws(t.id)&&Ys(t.type,t.data)}const js=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Nn,Encoder:Fs,get PacketType(){return T},isPacketValid:Xs,protocol:Vs},Symbol.toStringTag,{value:"Module"}));function ft(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const zs=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ar extends Q{constructor(e,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ft(e,"open",this.onopen.bind(this)),ft(e,"packet",this.onpacket.bind(this)),ft(e,"error",this.onerror.bind(this)),ft(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var i,r,o;if(zs.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const s={type:T.EVENT,data:n};if(s.options={},s.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const u=this.ids++,f=n.pop();this._registerAckCallback(u,f),s.id=u}const l=(r=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||r===void 0?void 0:r.writable,a=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!l||(a?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,n){var i;const r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[e]=n;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);n.call(this,new Error("operation has timed out"))},r),s=(...l)=>{this.io.clearTimeoutFn(o),n.apply(this,l)};s.withError=!0,this.acks[e]=s}emitWithAck(e,...n){return new Promise((i,r)=>{const o=(s,l)=>s?r(s):i(l);o.withError=!0,n.push(o),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...o)=>(this._queue[0],r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(r)):(this._queue.shift(),n&&n(null,...o)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:T.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case T.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case T.EVENT:case T.BINARY_EVENT:this.onevent(e);break;case T.ACK:case T.BINARY_ACK:this.onack(e);break;case T.DISCONNECT:this.ondisconnect();break;case T.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let i=!1;return function(...r){i||(i=!0,n.packet({type:T.ACK,id:e,data:r}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:T.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(e===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(e===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,e.data)}}}function Wt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Wt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-n:t+n}return Math.min(t,this.max)|0};Wt.prototype.reset=function(){this.attempts=0};Wt.prototype.setMin=function(t){this.ms=t};Wt.prototype.setMax=function(t){this.max=t};Wt.prototype.setJitter=function(t){this.jitter=t};class En extends Q{constructor(e,n){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,qe(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new Wt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const r=n.parser||js;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Rs(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const r=ft(n,"open",function(){i.onopen(),e&&e()}),o=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},s=ft(n,"error",o);if(this._timeout!==!1){const l=this._timeout,a=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),n.close()},l);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(r),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ft(e,"ping",this.onping.bind(this)),ft(e,"data",this.ondata.bind(this)),ft(e,"error",this.onerror.bind(this)),ft(e,"close",this.onclose.bind(this)),ft(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){Me(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new ar(this,e,n),this.nsps[e]=i),i}_destroy(e){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let i=0;i<n.length;i++)this.engine.write(n[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Qt={};function Te(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=Bs(t,e.path||"/socket.io"),i=n.source,r=n.id,o=n.path,s=Qt[r]&&o in Qt[r].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||s;let a;return l?a=new En(i,e):(Qt[r]||(Qt[r]=new En(i,e)),a=Qt[r]),n.query&&!e.query&&(e.query=n.queryKey),a.socket(n.path,e)}Object.assign(Te,{Manager:En,Socket:ar,io:Te,connect:Te});function Qs(){return"http://localhost:4000".replace(/\/$/,"")}const Ks=Tn("realtime",{state:()=>({socket:null,connected:!1,currentBoardId:null}),actions:{connect(){if(this.socket)return;const t=Te(Qs(),{transports:["websocket","polling"],auth:{userId:zr()}});t.on("connect",()=>{this.connected=!0,this.currentBoardId&&t.emit("board:join",{boardId:this.currentBoardId})}),t.on("disconnect",()=>{this.connected=!1}),t.on("board:activity_event_created",e=>{Promise.all([He(()=>Promise.resolve().then(()=>yi),void 0),He(()=>Promise.resolve().then(()=>Jo),void 0)]).then(([n,i])=>{const r=n.useActivityStore(),o=i.useBoardStore();r.boardId===e.activityEvent.boardId&&r.prepend(e.activityEvent),o.boardId===e.activityEvent.boardId&&o.refresh()})}),t.on("board:activity_cleared",e=>{He(()=>Promise.resolve().then(()=>yi),void 0).then(n=>{const i=n.useActivityStore();i.boardId===e.boardId&&(i.events=[],i.nextCursor=null)})}),this.socket=t},disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.connected=!1,this.currentBoardId=null)},joinBoard(t){this.connect(),this.currentBoardId=t,this.socket?.emit("board:join",{boardId:t})},leaveBoard(t){this.currentBoardId===t&&(this.socket?.emit("board:leave",{boardId:t}),this.currentBoardId=null)}}});function Js(t){switch(t.type){case"BOARD_CREATED":return"Board created";case"LIST_CREATED":return"List created";case"LIST_UPDATED":return"List updated";case"LIST_DELETED":return"List deleted";case"CARD_CREATED":return"Card created";case"CARD_UPDATED":return"Card updated";case"CARD_DELETED":return"Card deleted";case"CARD_MOVED":return"Card moved";case"UNDO":return"Undo";default:return t.type}}function Gs(t){return new Date(t.createdAt).toLocaleString()}const Zs={class:"row items-center q-col-gutter-md"},ta={class:"col"},ea={class:"text-h6"},na={class:"col-auto"},ia={key:1,class:"row items-center q-gutter-sm q-mt-md"},ra={key:2,class:"q-mt-md"},oa={class:"row items-start no-wrap",style:{"overflow-x":"auto",gap:"12px"}},sa={id:"lists-target",class:"row items-start no-wrap",style:{gap:"12px"}},aa={class:"row items-center q-gutter-sm"},la={class:"col text-subtitle2"},ca=["id","data-list-id"],ua={class:"row items-start q-col-gutter-xs"},da={class:"col"},ha={class:"text-body2"},fa={key:0,class:"text-caption text-grey-7"},pa={class:"col-auto"},ma={class:"q-pa-md"},ga={class:"row items-center"},va={class:"col-auto"},ya={class:"column"},ba={key:0,class:"text-caption text-grey-7"},_a=Si({__name:"BoardPage",setup(t){const e=Pr(),n=Cr(),i=Xi(),r=ji(),o=Ks(),s=lt(!1),l=lt(""),a=Ci({}),c=lt(!1),u=lt(null),f=lt(null),y=lt(""),d=lt(""),g=mt(()=>String(n.params.boardId??"")),C=mt({get:()=>i.lists,set:p=>{i.lists=p}});function $(p){return!(p.undoneAt||p.type==="UNDO")}async function P(p){await i.load(p),await r.loadRecent(p),o.joinBoard(p)}Cn(async()=>{await P(g.value)}),Ot(()=>g.value,async(p,v)=>{!p||p===v||(o.leaveBoard(v),i.clear(),r.clearLocal(),await P(p))}),Pe(()=>{o.leaveBoard(g.value)});async function J(){const p=l.value.trim();p&&(await i.addList(p),l.value="")}async function k(p){await i.deleteList(p),e.notify({type:"warning",message:"List deleted"})}async function W(p){const v=(a[p]??"").trim();v&&(await i.addCard(p,v),a[p]="")}async function O(){const p=i.lists.map(v=>v.id);await i.reorderLists(p)}async function K(p,v){if(!p||typeof p!="object")return;const m=p;if(m.oldIndex==null||m.newIndex==null)return;const _=m.item?.getAttribute("data-card-id"),I=m.to?.dataset?.listId??v;if(!(!_||!I))try{await i.moveCard(_,I,m.newIndex)}catch(F){e.notify({type:"negative",message:oe(F,"Move failed")}),await i.refresh()}}function L(p){u.value=p.id,f.value=p.listId,y.value=p.title,d.value=p.description??"",c.value=!0}async function X(){u.value&&(await i.patchCard(u.value,{title:y.value.trim(),description:d.value.trim().length?d.value:null}),c.value=!1,e.notify({type:"positive",message:"Card updated"}))}async function M(){!u.value||!f.value||(await i.deleteCard(u.value,f.value),c.value=!1,e.notify({type:"warning",message:"Card deleted"}))}async function b(p){try{await r.undo(p),e.notify({type:"positive",message:"Undone"}),await i.refresh()}catch(v){e.notify({type:"negative",message:oe(v,"Undo failed")})}}return(p,v)=>(tt(),Tt(Ir,{class:"q-pa-md"},{default:R(()=>[U("div",Zs,[U("div",ta,[U("div",ea,wt(N(i).board?.title??"Board"),1)]),U("div",na,[x(ut,{outline:"",icon:"history",label:"Activity",onClick:v[0]||(v[0]=m=>s.value=!0)})])]),N(i).error?(tt(),Tt(Hn,{key:0,class:"bg-red-1 text-red-10 q-mt-md",rounded:""},{default:R(()=>[ce(wt(N(i).error),1)]),_:1})):jt("",!0),N(i).loading?(tt(),Rt("div",ia,[x(Tr),v[7]||(v[7]=U("div",null,"Loading",-1))])):(tt(),Rt("div",ra,[U("div",oa,[x(N(vi),{modelValue:C.value,"onUpdate:modelValue":v[1]||(v[1]=m=>C.value=m),target:"#lists-target",animation:150,onEnd:O},{default:R(()=>[U("div",sa,[(tt(!0),Rt($e,null,We(C.value,m=>(tt(),Tt(zt,{key:m.id,"data-id":m.id,style:{width:"320px","min-width":"320px"},bordered:""},{default:R(()=>[x(Lt,{class:"q-pb-xs"},{default:R(()=>[U("div",aa,[U("div",la,wt(m.title),1),x(ut,{class:"col-auto",dense:"",flat:"",round:"",icon:"more_vert"},{default:R(()=>[x(ro,null,{default:R(()=>[x(Yn,{style:{"min-width":"160px"}},{default:R(()=>[Ye((tt(),Tt(Xn,{clickable:"",onClick:_=>k(m.id)},{default:R(()=>[x(je,{class:"text-negative"},{default:R(()=>[...v[8]||(v[8]=[ce("Delete list",-1)])]),_:1})]),_:1},8,["onClick"])),[[Xe]])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1024),x($n),x(Lt,{class:"q-pt-sm"},{default:R(()=>[x(N(vi),{"model-value":N(i).cardsByListId[m.id]??[],"onUpdate:modelValue":_=>N(i).cardsByListId[m.id]=_,target:`#cards-${m.id}`,group:"cards",animation:150,onEnd:_=>K(_,m.id)},{default:R(()=>[U("div",{id:`cards-${m.id}`,class:"column","data-list-id":m.id,style:{gap:"8px"}},[(tt(!0),Rt($e,null,We(N(i).cardsByListId[m.id]??[],_=>(tt(),Tt(zt,{key:_.id,"data-id":_.id,"data-card-id":_.id,flat:"",bordered:""},{default:R(()=>[x(Lt,{class:"q-pa-sm"},{default:R(()=>[U("div",ua,[U("div",da,[U("div",ha,wt(_.title),1),_.description?(tt(),Rt("div",fa,wt(_.description),1)):jt("",!0)]),U("div",pa,[x(ut,{dense:"",flat:"",round:"",icon:"edit",onClick:I=>L(_)},null,8,["onClick"])])])]),_:2},1024)]),_:2},1032,["data-id","data-card-id"]))),128))],8,ca)]),_:2},1032,["model-value","onUpdate:modelValue","target","onEnd"]),x(ue,{modelValue:a[m.id],"onUpdate:modelValue":_=>a[m.id]=_,dense:"",placeholder:"Add a card",onKeyup:Vn(_=>W(m.id),["enter"])},{append:R(()=>[x(ut,{dense:"",flat:"",icon:"add",disable:!(a[m.id]||"").trim(),onClick:_=>W(m.id)},null,8,["disable","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1024)]),_:2},1032,["data-id"]))),128))])]),_:1},8,["modelValue"]),x(zt,{style:{width:"320px","min-width":"320px"},bordered:"",flat:""},{default:R(()=>[x(Lt,null,{default:R(()=>[x(ue,{modelValue:l.value,"onUpdate:modelValue":v[2]||(v[2]=m=>l.value=m),dense:"",placeholder:"Add a list",onKeyup:Vn(J,["enter"])},{append:R(()=>[x(ut,{dense:"",flat:"",icon:"add",disable:!l.value.trim(),onClick:J},null,8,["disable"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])])),x(Wn,{modelValue:s.value,"onUpdate:modelValue":v[3]||(v[3]=m=>s.value=m),position:"right"},{default:R(()=>[x(zt,{style:{width:"420px","max-width":"90vw",height:"100vh"}},{default:R(()=>[U("div",ma,[U("div",ga,[v[9]||(v[9]=U("div",{class:"col text-subtitle1"},"Activity",-1)),U("div",va,[Ye(x(ut,{dense:"",flat:"",round:"",icon:"close"},null,512),[[Xe]])])]),x($n,{class:"q-my-sm"}),N(r).error?(tt(),Tt(Hn,{key:0,class:"bg-red-1 text-red-10 q-mb-sm",rounded:""},{default:R(()=>[ce(wt(N(r).error),1)]),_:1})):jt("",!0),U("div",ya,[x(Yn,{bordered:"",separator:""},{default:R(()=>[(tt(!0),Rt($e,null,We(N(r).events,m=>(tt(),Tt(Xn,{key:m.id},{default:R(()=>[x(je,null,{default:R(()=>[x(jn,null,{default:R(()=>[U("span",null,wt(N(Js)(m)),1),m.undoneAt?(tt(),Rt("span",ba," (undone)")):jt("",!0)]),_:2},1024),x(jn,{caption:""},{default:R(()=>[ce(wt(N(Gs)(m))+"  "+wt(m.actorUserId),1)]),_:2},1024)]),_:2},1024),x(je,{side:""},{default:R(()=>[$(m)?(tt(),Tt(ut,{key:0,dense:"",outline:"",size:"sm",label:"Undo",onClick:_=>b(m.id)},null,8,["onClick"])):jt("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),x(ut,{class:"q-mt-sm",outline:"",label:"Load more",disable:!N(r).nextCursor||N(r).loading,onClick:N(r).loadMore},null,8,["disable","onClick"])])])]),_:1})]),_:1},8,["modelValue"]),x(Wn,{modelValue:c.value,"onUpdate:modelValue":v[6]||(v[6]=m=>c.value=m)},{default:R(()=>[x(zt,{style:{"min-width":"420px"}},{default:R(()=>[x(Lt,null,{default:R(()=>[...v[10]||(v[10]=[U("div",{class:"text-h6"},"Edit card",-1)])]),_:1}),x(Lt,{class:"q-gutter-sm"},{default:R(()=>[x(ue,{modelValue:y.value,"onUpdate:modelValue":v[4]||(v[4]=m=>y.value=m),label:"Title"},null,8,["modelValue"]),x(ue,{modelValue:d.value,"onUpdate:modelValue":v[5]||(v[5]=m=>d.value=m),type:"textarea",label:"Description",autogrow:""},null,8,["modelValue"])]),_:1}),x(Lr,{align:"between"},{default:R(()=>[x(ut,{flat:"",color:"negative",label:"Delete",onClick:M}),U("div",null,[Ye(x(ut,{flat:"",label:"Cancel"},null,512),[[Xe]]),x(ut,{color:"primary",label:"Save",disable:!y.value.trim(),onClick:X},null,8,["disable"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),wa=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},ka=wa(_a,[["__scopeId","data-v-86eecce3"]]);export{ka as default};
